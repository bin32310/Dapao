<?xml version="1.0" encoding="UTF-8"?>

<!-- /mappers/ItemMapper.xml -->

<!-- DTD추가 --><!-- mapper 태그를 사용할 수 있게 해준다  --><!-- 이 코드는 마이바티스 홈페이지에 가면 있다 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <!-- mapper 태그 안에는 주석금지--> <!-- 필요한 쿼리문만 작성 -->
  <!-- namespace정보는 외부에서 해당 mapper(xml)를 찾을 수 있는 이름 , 실제 주소가 아니다-->
  <mapper namespace="com.dapao.mapper.ItemMapper">
  
  
  <update id="viewCnt">
  	update item set it_ivew = it_view+1  
  	where it_no=#{it_no}
  </update>
  
  <insert id="itemWrite">
	  insert into item(us_id,it_title,it_price,it_content,it_con,it_cate) 
	  values(#{us_id},#{it_title},#{it_price},#{it_content},#{it_con},#{it_cate})
  </insert>
  
  <select id="itemWriteCheck" resultType="Integer">
  	select max(it_no) from item 
  	where us_id=#{us_id} 
  </select>
  
  <select id="itemSearch" resultType="ItemVO">
  	select * from item 
  	where it_title like CONCAT('%', #{it_title}, '%')
  </select>
  
  <select id="itemCate" resultType="ItemVO">
  	select * from item 
  	where it_cate = #{it_cate}
  </select>
  
  <select id="itemDetail" resultType="TotalVO">
  	select i.*, u.* from item i join us u 
  	on i.us_id = u.us_id 
  	where i.it_no=#{it_no}
  </select>
  
  <select id="itemLove" resultType="int">
  	select count(*) from love 
  	where us_id=#{us_id} and it_no=#{it_no}
  </select>
  
  <insert id="itemLoveInsert">
  	insert into love(it_no, us_id) 
  	values(#{it_no},#{us_id})
  </insert>
  
  <delete id="itemLoveDelete">
  	delete from love 
  	where us_id = #{us_id} and it_no = #{it_no}
  </delete>
  
  
  <select id="sellerItem" resultType="ItemVO">
  select it_img, it_title, it_no
  from item 
  where us_id=#{us_id} and it_no != #{it_no} 
  order by rand() limit 5;
  </select>
  
  <select id="sameCate" resultType="ItemVO">
  select it_img, it_title, it_no 
  from item 
  where it_cate=#{it_cate} and it_no != #{it_no} 
  order by rand() limit 5;
  </select>
  
  <select id="yourInfo" resultType="UserVO">
  	select * from us 
  	where us_id=#{us_id}
  </select>
  
  
  <select id="yourItem" resultType="ItemVO">
  select it_img, it_title, it_no from item 
  where us_id=#{us_id} 
  order by it_no desc;
  </select>
  
  
  </mapper>